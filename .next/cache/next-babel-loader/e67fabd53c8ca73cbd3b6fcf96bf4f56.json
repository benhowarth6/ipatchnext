{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useState, createContext, useContext, useEffect } from 'react';\nimport { initiateCheckout } from '../lib/payments.js';\nimport { getStorageItem, setStorageItem } from '../lib/storage.js';\nimport products from '../../shared/products.json';\nconst CART_STATE_KEY = 'cart';\nconst defaultCart = {\n  products: {}\n};\nexport const CartContext = /*#__PURE__*/createContext();\nexport function useCartState() {\n  const {\n    0: cart,\n    1: updateCart\n  } = useState(defaultCart);\n  useEffect(() => {\n    const data = getStorageItem(CART_STATE_KEY);\n\n    if (data) {\n      updateCart(data);\n    }\n  }, []);\n  useEffect(() => {\n    setStorageItem(CART_STATE_KEY, cart);\n  }, [cart]);\n  const cartItems = Object.keys(cart.products).map(key => {\n    const product = products.find(({\n      id\n    }) => `${id}` === `${key}`);\n    return _objectSpread(_objectSpread({}, cart.products[key]), {}, {\n      pricePerUnit: product.price\n    });\n  });\n  const subtotal = cartItems.reduce((accumulator, {\n    pricePerUnit,\n    quantity\n  }) => {\n    return accumulator + pricePerUnit * quantity;\n  }, 0);\n  const quantity = cartItems.reduce((accumulator, {\n    quantity\n  }) => {\n    return accumulator + quantity;\n  }, 0);\n\n  function addToCart({\n    id\n  }) {\n    updateCart(prev => {\n      let cart = _objectSpread({}, prev);\n\n      if (cart.products[id]) {\n        cart.products[id].quantity = cart.products[id].quantity + 1;\n      } else {\n        cart.products[id] = {\n          id,\n          quantity: 1\n        };\n      }\n\n      return cart;\n    });\n  }\n\n  function checkout() {\n    initiateCheckout({\n      lineItems: cartItems.map(({\n        id,\n        quantity\n      }) => {\n        return {\n          price: id,\n          quantity\n        };\n      })\n    });\n  }\n  /**\n   * @lesson-15-todo Exercise 3\n   * We have an addToCart function that adds 1 item to\n   * a product by its ID, but we dont have a way to\n   * update that value manually. What kind of function\n   * can we add that allows us to externally update\n   * a quantity by product ID and make that available\n   * globally?\n   */\n\n\n  return {\n    cart,\n    cartItems,\n    subtotal,\n    quantity,\n    addToCart,\n    checkout\n  };\n}\nexport function useCart() {\n  const cart = useContext(CartContext);\n  return cart;\n}","map":{"version":3,"sources":["/Users/benhowarth/Desktop/iPatchNext/hooks/use-cart.js"],"names":["useState","createContext","useContext","useEffect","initiateCheckout","getStorageItem","setStorageItem","products","CART_STATE_KEY","defaultCart","CartContext","useCartState","cart","updateCart","data","cartItems","Object","keys","map","key","product","find","id","pricePerUnit","price","subtotal","reduce","accumulator","quantity","addToCart","prev","checkout","lineItems","useCart"],"mappings":"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","sourcesContent":["import { useState, createContext, useContext, useEffect } from 'react';\n\nimport { initiateCheckout } from '../lib/payments.js'\nimport { getStorageItem, setStorageItem } from '../lib/storage.js'\n\nimport products from '../../shared/products.json';\n\nconst CART_STATE_KEY = 'cart';\n\nconst defaultCart = {\n  products: {}\n}\n\nexport const CartContext = createContext();\n\nexport function useCartState() {\n  const [cart, updateCart] = useState(defaultCart);\n\n  useEffect(() => {\n    const data = getStorageItem(CART_STATE_KEY);\n    if ( data ) {\n      updateCart(data);\n    }\n  }, []);\n\n  useEffect(() => {\n    setStorageItem(CART_STATE_KEY, cart);\n  }, [cart]);\n\n  const cartItems = Object.keys(cart.products).map(key => {\n    const product = products.find(({ id }) => `${id}` === `${key}`);\n    return {\n      ...cart.products[key],\n      pricePerUnit: product.price\n    }\n  });\n\n  const subtotal = cartItems.reduce((accumulator, { pricePerUnit, quantity }) => {\n    return accumulator + ( pricePerUnit * quantity );\n  }, 0);\n\n  const quantity = cartItems.reduce((accumulator, { quantity }) => {\n    return accumulator + quantity;\n  }, 0);\n\n  function addToCart({ id }) {\n    updateCart((prev) => {\n      let cart = {...prev};\n\n      if ( cart.products[id] ) {\n        cart.products[id].quantity = cart.products[id].quantity + 1;\n      } else {\n        cart.products[id] = {\n          id,\n          quantity: 1\n        }\n      }\n\n      return cart;\n    })\n  }\n\n  function checkout() {\n    initiateCheckout({\n      lineItems: cartItems.map(({ id, quantity }) => {\n        return {\n          price: id,\n          quantity\n        }\n      })\n    })\n  }\n\n  /**\n   * @lesson-15-todo Exercise 3\n   * We have an addToCart function that adds 1 item to\n   * a product by its ID, but we dont have a way to\n   * update that value manually. What kind of function\n   * can we add that allows us to externally update\n   * a quantity by product ID and make that available\n   * globally?\n   */\n\n  return {\n    cart,\n    cartItems,\n    subtotal,\n    quantity,\n    addToCart,\n    checkout\n  }\n\n}\n\nexport function useCart() {\n  const cart = useContext(CartContext);\n  return cart;\n}"]},"metadata":{},"sourceType":"module"}